import{a as Y}from"./chunk-V5FBXNII.js";import{a as X}from"./chunk-BKURUGA6.js";import{a as Q}from"./chunk-TUGNCIOV.js";import{$ as P,B as u,C as p,D as F,E as N,F as e,G as i,H as m,I as D,J as w,M as _,Q as a,R as d,S as y,T as O,Y as V,Z as $,c as L,ha as H,ia as W,ja as q,m as R,qa as z,ta as G,v as A,va as B,w as n,wa as J,x as M,xa as K}from"./chunk-U6WCF6FZ.js";var le=()=>[5,4,3,2,1],oe=(s,f)=>["/chapter",s,f];function se(s,f){s&1&&(e(0,"div")(1,"p"),a(2,"Loading manga details..."),i()())}function me(s,f){if(s&1&&(D(0),m(1,"input",61)(2,"label",62),w()),s&2){let t=f.$implicit,l=_(2);n(),p("id","star"+t)("value",t)("checked",l.Math.floor(l.mangaDetails.rating)===t),n(),F("filled",l.mangaDetails.rating>=t)("half",l.mangaDetails.rating>=t-.5&&l.mangaDetails.rating<t),p("for","star"+t)}}function de(s,f){if(s&1&&(e(0,"li")(1,"a",69),a(2),i(),e(3,"span",66),a(4),i(),e(5,"span",67),a(6),i()()),s&2){let t=f.$implicit,l=_(3);n(),p("routerLink",P(6,oe,t.id,l.mangaIds))("id",t.id),n(),O(" Chapter ",t.chapterNumber,"",t.title?" - "+t.title:""," "),n(2),d(t.views),n(2),d(t.uploadedTime)}}function ce(s,f){if(s&1&&(D(0),e(1,"div",63)(2,"ul",64)(3,"li")(4,"span",65),a(5,"Chapter name"),i(),e(6,"span",66),a(7,"View"),i(),e(8,"span",67),a(9,"Uploaded"),i()()(),e(10,"ul",68),u(11,de,7,9,"li",46),i()(),w()),s&2){let t=_(2);n(11),p("ngForOf",t.mangaDetails.chapters)}}function pe(s,f){if(s&1&&(D(0),e(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"a",12),a(6,"Read Manga Online"),i()(),e(7,"div",11)(8,"a",13),a(9),i()()()(),e(10,"div",14)(11,"div",15)(12,"div",16)(13,"div",17),m(14,"img",18),e(15,"span"),a(16),i(),e(17,"span",19)(18,"span",20),a(19),i(),e(20,"span",21),m(21,"i",22),i()()(),e(22,"a",23),a(23,"Read Chapter List"),i()(),e(24,"div",24)(25,"h2",25)(26,"a",26),a(27),i()(),e(28,"ul",27)(29,"li",28)(30,"div",29)(31,"span",30),m(32,"i",31),i(),e(33,"h6",32),a(34,"Alternative:"),i()(),e(35,"div",33)(36,"h6",34),a(37),i()()(),e(38,"li",28)(39,"div",29)(40,"span",30),m(41,"i",35),i(),e(42,"h6",32),a(43,"Author(s) :"),i()(),e(44,"div",36)(45,"a",12),a(46),i()()(),e(47,"li",28)(48,"div",29)(49,"span",30),m(50,"i",37),i(),e(51,"h6",32),a(52,"Status :"),i()(),e(53,"div",33)(54,"h6",38),a(55),i()()(),e(56,"li",28)(57,"div",29)(58,"span",30),m(59,"i",39),i(),e(60,"h6",32),a(61,"Genres "),i()(),e(62,"div",40)(63,"h6"),a(64),i()()(),e(65,"li",28)(66,"div",29)(67,"span",30),m(68,"i",41),i(),e(69,"h6",32),a(70,"Updated:"),i()(),e(71,"div",33)(72,"h6",42),a(73),i()()(),e(74,"li",28)(75,"div",29)(76,"span",30),m(77,"i",43),i(),e(78,"h6",32),a(79,"Views:"),i()(),e(80,"div",33)(81,"h6",44),a(82),i()()(),e(83,"li",28)(84,"div",29)(85,"span",30),m(86,"i",45),i(),e(87,"h6",32),a(88,"Rating:"),i()(),e(89,"div",33)(90,"div",19),u(91,me,3,8,"ng-container",46),i()()()(),e(92,"div",47)(93,"em"),a(94,"MangaNato.com rate : "),e(95,"span",48),a(96),i(),a(97),i()(),e(98,"p",49),m(99,"img",50),i(),e(100,"div",51)(101,"a",52),m(102,"i",53),a(103," Likes "),e(104,"span",54),a(105),i()(),e(106,"a",52),a(107,"Share"),i()()()(),e(108,"div",55)(109,"h6"),a(110,"Description :"),i(),e(111,"div",56),a(112),i()(),e(113,"div",57)(114,"a",58),a(115," SHOW MORE "),e(116,"span",59),m(117,"i",60),i()()()(),u(118,ce,12,1,"ng-container",6),i(),w()),s&2){let t=_();n(9),d(t.mangaDetails.title),n(5),p("src",t.mangaDetails.cover,A),n(),N("badge "+t.mangaDetails.popularityTag+"_badge"),n(),d(t.mangaDetails.popularityTag),n(3),d(t.mangaDetails.rating),n(8),d(t.mangaDetails.title),n(10),y(" ",t.mangaDetails.altTitles.join(", ")," "),n(9),d(t.mangaDetails.author),n(9),d(t.mangaDetails.status),n(9),d(t.mangaDetails.genres.join(", ")),n(9),d(t.mangaDetails.lastUpdated),n(9),d(t.mangaDetails.views),n(9),p("ngForOf",$(19,le)),n(5),d(t.mangaDetails.rating),n(),y("/ 5 - ",t.mangaDetails.totalLikes," votes"),n(8),d(t.mangaDetails.totalLikes),n(7),y(" ",t.mangaDetails.description," "),n(6),p("ngIf",t.mangaDetails.chapters.length>0)}}var we=(()=>{class s{constructor(t,l){this.mangaService=t,this.route=l,this.mangaData=[],this.Math=Math}ngOnInit(){this.route.paramMap.subscribe(t=>{let l=t.get("id");this.mangaIds=l,l&&this.loadMangaData(l)})}loadMangaData(t){this.mangaService.getManga(t).subscribe(l=>L(this,null,function*(){try{let o=l.data;if(!o)throw new Error("Manga not found");let c="https://via.placeholder.com/150",x=o.relationships.find(r=>r.type==="cover_art");if(x)try{let g=(yield this.mangaService.getCoverImage(x.id).toPromise()).data?.attributes?.fileName;g&&(c=`https://uploads.mangadex.org/covers/${t}/${g}.256.jpg`)}catch(r){console.error("Error fetching cover:",r)}let T=o.relationships.find(r=>r.type==="author"||r.type==="artist"),I="Unknown";if(T)try{I=(yield this.mangaService.getAuthor(T.id).toPromise()).data?.attributes?.name||"Unknown"}catch(r){console.error("Error fetching author:",r)}let Z=o.attributes.altTitles?.map(r=>Object.values(r)[0])||[],ee=o.attributes.altTitles?.find(r=>r.en)?.en||(o.attributes.altTitles?.length?Object.values(o.attributes.altTitles[0])[0]:"No Title"),k=[];try{let r=[],g=0,h=!0;for(;h;){let v=yield this.mangaService.getChaptersList(t,100,g).toPromise(),re=v.data.map(b=>({id:b.id,chapterNumber:b.attributes.chapter||"N/A",title:b.attributes.title||"",views:Math.floor(Math.random()*5e3)+1e3,uploadedTime:new Date(b.attributes.readableAt).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric"})}));r=r.concat(re),v.data.length===100?g+=100:h=!1}let C=new Map;r.forEach(v=>{C.has(v.chapterNumber)||C.set(v.chapterNumber,v)}),k=Array.from(C.values())}catch(r){console.error("Error fetching chapters:",r)}let te=o.attributes.tags.map(r=>r.attributes.name.en),S=0,U="1",j=0;try{let g=(yield this.mangaService.getStats(t).toPromise()).statistics?.[t];S=g?.follows||0;let h=g?.rating?.average||0;U=h?(h/2).toFixed(1):"1",j=g?.rating?.count||0}catch(r){console.error("Error fetching stats:",r)}let E="",ie=new Date;S>5e4?E="ss":S>1e4&&(E="hot"),(ie.getTime()-new Date(o.attributes.createdAt).getTime())/(1e3*60*60*24)<30&&(E="new");let ae=new Date(o.attributes.updatedAt).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric"}),ne={id:t,title:o.attributes.title.en||ee,cover:c,altTitles:Z,description:o.attributes.description.en||"No Description",author:I,status:o.attributes.status?o.attributes.status.charAt(0).toUpperCase()+o.attributes.status.slice(1):"Unknown",genres:te,lastUpdated:ae,views:S,rating:U,totalLikes:j,popularityTag:E,chapters:k};this.mangaDetails=ne}catch(o){console.error("Error processing manga details:",o)}}))}formatTime(t){let l=new Date(t),c=Math.floor((new Date-l)/1e3);if(c<60)return`${c} seconds ago`;if(c<3600)return`${Math.floor(c/60)} min ago`;if(c<86400)return`${Math.floor(c/3600)} hour ago`;if(c<604800)return`${Math.floor(c/86400)} day ago`;let x={year:"numeric",month:"short",day:"numeric"};return l.toLocaleDateString("en-US",x)}static{this.\u0275fac=function(l){return new(l||s)(M(Q),M(z))}}static{this.\u0275cmp=R({type:s,selectors:[["app-detail-view"]],standalone:!0,features:[V],decls:13,vars:2,consts:[[1,"d-flex","flex-column","h-m-100"],[1,"flex-fill"],[1,"main_section"],[1,"container"],[1,"row"],[1,"col-md-8"],[4,"ngIf"],[1,"col-md-4"],[1,"detail_panel_wrapper"],[1,"detail_panel_header"],[1,"breadcrumb_wrapper"],[1,"breadcrumb_item"],["href","javascript:void(0)"],["href","javascript:void(0)","id","mangaData"],[1,"detail_panel_body"],[1,"detail_panel_content"],[1,"item_img_wrapper"],[1,"item_img"],["id","manga-cover","referrerpolicy","no-referrer","alt","",1,"img-fluid",3,"src"],[1,"rating"],["id","manga-rating",1,"content"],[1,"icon"],[1,"fas","fa-star"],["href","javscript:void(0)",1,"btn_read"],[1,"item_content"],[1,"item_title"],["href","javascript:void(0)","id","manga-title"],[1,"detail_list"],[1,"detail_item"],[1,"detail_item_label"],[1,"label_icon"],[1,"fas","fa-filter"],[1,"label_text"],[1,"detail_item_content"],["id","manga-alternative-titles"],[1,"fas","fa-user"],["id","manga-author",1,"detail_item_content"],[1,"fas","fa-ellipsis-h"],["id","manga-status"],[1,"fas","fa-list"],["id","manga-genres",1,"detail_item_content"],[1,"fas","fa-clock"],["id","manga-last-update"],[1,"far","fa-eye"],["id","manga-views"],[1,"fas","fa-plus"],[4,"ngFor","ngForOf"],[1,"votes_wrap"],["id","manga-rating-2"],[1,"mb-0"],["src","assets/images/bookmark.png","alt","bookmark",1,"img-fluid","bookmark_img"],[1,"d-flex","gap-2"],["href","javascript:void(0)",1,"btn","btn-primary","btn-sm","d-flex","gap-1","align-items-center","text-white"],[1,"fas","fa-thumbs-up"],["id","manga-likes"],[1,"detail_item_discription"],["id","manga-description",1,"discription_content"],[1,"detail_item_btn_wrapper"],["href","javascript:void(0)",1,"item_read_more_btn"],[1,"ms-1"],[1,"fas","fa-arrow-down"],["type","radio","name","rating","disabled","",3,"id","value","checked"],[3,"for"],[1,"panel_chapter_list"],[1,"chapter_list_header"],[1,"chapter-name"],[1,"chapter-view"],[1,"chapter-time"],["id","chapter_list_container",1,"chapter_list_body"],[1,"chapter-name",3,"routerLink","id"]],template:function(l,o){l&1&&(e(0,"div",0),m(1,"app-header"),e(2,"main",1),m(3,"app-top-week"),e(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5),u(8,se,3,0,"div",6)(9,pe,119,20,"ng-container",6),i(),e(10,"div",7),m(11,"app-sidebar"),i()()()()(),m(12,"app-footer"),i()),l&2&&(n(8),p("ngIf",!o.mangaDetails),n(),p("ngIf",o.mangaDetails))},dependencies:[K,J,q,H,W,X,Y,B,G]})}}return s})();export{we as DetailViewComponent};
