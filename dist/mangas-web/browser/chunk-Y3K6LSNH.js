import{a as re}from"./chunk-BKURUGA6.js";import{a as ae}from"./chunk-TUGNCIOV.js";import{$ as C,B as S,C as l,D as y,E as z,F as t,G as e,H as s,I as T,J as L,K as B,L as w,M as P,Q as i,R as v,S as f,Y as K,Z as d,_ as W,c as h,ha as Y,ia as Z,ja as J,m as U,q as H,qa as Q,r as V,sa as X,ta as ee,v as $,va as te,w as a,wa as ie,x as E,xa as ne}from"./chunk-U6WCF6FZ.js";var _=()=>["/list-view"],oe=()=>({status:"all"}),ce=()=>["/"],pe=()=>({category:"latest"}),ue=()=>({category:"newest"}),ge=()=>({category:"top-view"}),ve=()=>({status:"completed"}),_e=()=>({status:"ongoing"}),fe=o=>["/manga",o],he=(o,p)=>["/chapter",o,p],Se=(o,p)=>({genres:o,genrenames:p});function xe(o,p){o&1&&(t(0,"div",66),s(1,"div",67),e())}function Ee(o,p){if(o&1&&(t(0,"span"),i(1),e()),o&2){let n=P().$implicit;a(),f(": ",n.chapterTitle,"")}}function ye(o,p){if(o&1&&(T(0),t(1,"div",68)(2,"div",69),s(3,"img",70),t(4,"span"),i(5),e(),t(6,"span",71)(7,"span",72),i(8),e(),t(9,"span",11),s(10,"i",73),e()()(),t(11,"div",74)(12,"h2",75)(13,"a",76),i(14),e()(),t(15,"div",77)(16,"a",78),i(17),S(18,Ee,2,1,"span",79),e()(),t(19,"div",80)(20,"div",81)(21,"span",82),s(22,"i",83),e(),t(23,"span"),i(24),e()(),t(25,"div",84)(26,"span",82),s(27,"i",85),e(),t(28,"span"),i(29),e()(),t(30,"div",86)(31,"span",82),s(32,"i",87),e(),t(33,"span"),i(34),e()()(),t(35,"div",88),i(36),e(),t(37,"div",89)(38,"a",90),i(39,"Read More"),e()()()(),L()),o&2){let n=p.$implicit;a(3),l("src",n.cover,$)("alt",n.title),a(),z("badge "+n.popularityTag+"_badge"),a(),v(n.popularityTag),a(3),v(n.rating),a(5),l("routerLink",W(15,fe,n.id)),a(),v(n.title),a(2),l("routerLink",C(17,he,n.chapterId,n.id)),a(),f(" Chapter ",n.chapter," "),a(),l("ngIf",n.chapterTitle),a(6),v(n.views),a(5),v(n.lastUpdated),a(5),v(n.author),a(2),f(" ",n.description," ")}}function we(o,p){if(o&1){let n=B();t(0,"div",91)(1,"a",55),w("click",function(){let r=H(n).$implicit,u=P();return V(u.onPageChange(r))}),i(2),e()()}if(o&2){let n=p.$implicit,m=P();y("active",n===m.currentPage),a(2),v(n)}}function Pe(o,p){if(o&1&&(T(0),t(1,"li",92)(2,"a",28),i(3),e()(),L()),o&2){let n=p.$implicit;a(),l("id",n.id),a(),l("routerLink",d(4,_))("queryParams",C(5,Se,n.id,n.name)),a(),f(" ",n.name," ")}}var qe=(()=>{class o{constructor(n,m,r){this.mangaService=n,this.route=m,this.router=r,this.genreNames=[],this.page=1,this.mangaGenresList=[],this.filteredMangasList=[],this.isLoading=!1,this.currentPage=1,this.itemsPerPage=10,this.totalManga=0,this.totalPages=0,this.pagesToShow=[],this.offset=0,this.limit=10}ngOnInit(){this.route.queryParams.subscribe(n=>{this.currentPage=n.offset?parseInt(n.offset)/this.itemsPerPage+1:1,this.pagesToShow=[],this.offset=parseInt(n.offset)||0,this.limit=parseInt(n.limit)||10,this.loadFilteredMangas(this.offset,this.limit)}),this.loadGenresList()}capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)}loadFilteredMangas(n,m){return h(this,null,function*(){let r=n,u=m;this.isLoading=!0,this.mangaService.getHotMangaList(r,u).subscribe(M=>h(this,null,function*(){let I=yield Promise.all(M.data.map(c=>h(this,null,function*(){let F="https://via.placeholder.com/150",k="Unknown",be=null,A=c.relationships.find(g=>g.type==="cover_art");if(A){let G=(yield this.mangaService.getCoverImage(A.id).toPromise()).data?.attributes?.fileName;G&&(F=`https://uploads.mangadex.org/covers/${c.id}/${G}.256.jpg`)}let R=c.relationships.find(g=>g.type==="author");R&&(k=(yield this.mangaService.getAuthor(R.id).toPromise()).data?.attributes?.name||"Unknown");let N=yield this.mangaService.getLatestChapter(c.id).toPromise(),j=N?.data?.[0]?.attributes||{},O=(yield this.mangaService.getStats(c.id).toPromise()).statistics?.[c.id]||{},b=O.follows||0,q=O.rating?.average||0,le=q?(q/2).toFixed(1):"N/A",x="";b>5e4?x="ss":b>1e4&&(x="hot");let se=new Date(c.attributes.createdAt);(new Date().getTime()-se.getTime())/864e5<30&&(x="new");let D=c.attributes.altTitles||[],me=D.find(g=>g.en)?.en||Object.values(D[0]||{})[0]||"No Title",de=new Date(c.attributes.updatedAt).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric"});return this.totalManga=M.total||47276,this.totalPages=Math.ceil(this.totalManga/this.itemsPerPage),this.updatePagesArray(),this.isLoading=!1,{id:c.id,title:c.attributes.title.en||me,cover:F,description:c.attributes.description.en||"No Description",author:k,chapterId:N?.data?.[0]?.id,chapter:j.chapter||"N/A",chapterTitle:j.title||"",tags:c.attributes.tags.map(g=>g.attributes.name.en),rating:le,lastUpdated:de,views:b,popularityTag:x}})));this.filteredMangasList=I,console.log(I)}))})}onPageChange(n){if(n<1||n>this.totalPages||n===this.currentPage)return;this.currentPage=n;let m=(n-1)*this.itemsPerPage;this.router.navigate([],{relativeTo:this.route,queryParams:{offset:m},queryParamsHandling:"merge"})}updatePagesArray(){let m=Math.max(1,this.currentPage-2),r=Math.min(this.totalPages,this.currentPage+2);this.pagesToShow=[];for(let u=m;u<=r;u++)this.pagesToShow.push(u)}loadGenresList(){this.mangaService.getGenresList().subscribe(n=>h(this,null,function*(){let m=yield Promise.all(n.data.map(r=>h(this,null,function*(){return{id:r.id,name:r.attributes.name.en}})));this.mangaGenresList=m.sort((r,u)=>r.name.localeCompare(u.name))}))}static{this.\u0275fac=function(m){return new(m||o)(E(ae),E(Q),E(X))}}static{this.\u0275cmp=U({type:o,selectors:[["app-top-manga"]],standalone:!0,features:[K],decls:205,vars:41,consts:[["class","box-loader",4,"ngIf"],[1,"d-flex","flex-column","h-m-100"],[1,"flex-fill"],[1,"main_section"],[1,"container"],[1,"row"],[1,"col-md-12"],[1,"filter_wrapper"],[1,"filter_header"],[1,"filter_title"],["href","javascript:void(0)",1,"filter_btn","stretched-link"],[1,"icon"],[1,"fas","fa-plus"],[1,"filter_text"],["id","filter_body",1,"filter_body","d-none"],[1,"genre_wrapper"],[1,"genre_info_btn_wrapper"],["href","javscript:void(0)",1,"add_genre","genre_info_btn"],[1,"fas","fa-plus-circle"],["href","javscript:void(0)",1,"remove_genre","genre_info_btn"],[1,"fas","fa-minus-circle"],["href","javascript:void(0)","id","info_genre","onclick","HideGenresInfo()",1,"info_genre","genre_info_btn"],[1,"fas","fa-question-circle"],["id","genre_info",1,"genre_info","d-none"],[1,"add_genre","icon"],[1,"remove_genre","icon"],[1,"genres_list_wrapper"],["id","status_all",1,"list_item","status_all"],[3,"routerLink","queryParams"],[1,"list_item"],["href","javascript:void(0)"],[1,"list_item","inactive"],[1,"row","mt-2"],[1,"col-md-3"],[1,"d-flex","align-items-center","gap-2"],["for","",1,"form-label","fw-bold","text-nowrap","small"],[1,"form-select"],["selected",""],["value",""],["type","text","placeholder","Search Manga",1,"form-control"],[1,"search_btn"],[1,"row","mt-2","mb-2"],["type","text","placeholder","Search Manga","value","https://manganato.com/advanced_search?s=all&page=1","readonly","",1,"form-control"],[1,"list_view_container"],[1,"breadcrumb_wrapper"],[1,"breadcrumb_item"],[1,"pe-1",3,"routerLink"],["href","javascript:void(0)",1,"pe-1"],["id","currentPageNumber"],["id","list_view_items",1,"list_view_body"],[4,"ngFor","ngForOf"],[1,"pagination_wrapper"],[1,"total-page","page-item"],[1,"pages_wrapper"],[1,"page-item","active"],["href","javascript:void(0)",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"genres_section","list_view"],[1,"section_content"],["id","genres_list_container",1,"genres_list"],[1,"genres_list","border-bottom"],["id","sort_latest",1,"list_item","sort_latest"],["id","sort_newest",1,"list_item","sort_newest"],["id","sort_top-view",1,"list_item","sort_top-view"],["id","status_completed",1,"list_item","status_completed"],["id","status_ongoing",1,"list_item","status_ongoing"],[1,"box-loader"],[1,"loader"],[1,"list_view_item"],[1,"item_img"],["referrerpolicy","no-referrer",1,"img-fluid",3,"src","alt"],[1,"rating"],[1,"content"],[1,"fas","fa-star"],[1,"item_content"],[1,"item_title"],[3,"routerLink"],[1,"item_chapter"],[1,"chapter_link",3,"routerLink"],[4,"ngIf"],[1,"item_info_wrapper"],[1,"info_item","item_views"],[1,"icon","me-1"],[1,"fas","fa-eye"],[1,"info_item","item_updated_date"],[1,"fas","fa-calendar"],[1,"info_item","item_author"],[1,"fas","fa-user"],[1,"item_discription"],[1,"item_btn_wrapper"],["href","javascript:void(0)",1,"item_read_more_btn"],[1,"page-item"],[1,"list_item",3,"id"]],template:function(m,r){m&1&&(S(0,xe,2,0,"div",0),t(1,"div",1),s(2,"app-header"),t(3,"main",2),s(4,"app-top-week"),t(5,"section",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h2",9),i(12,"FILTER (ADVANCED SEARCH)"),e(),t(13,"a",10)(14,"span",11),s(15,"i",12),e(),t(16,"span",13),i(17,"Show"),e()()(),t(18,"div",14)(19,"h5"),i(20,"Genres:"),e(),t(21,"div",15)(22,"div",16)(23,"a",17)(24,"span",11),s(25,"i",18),e(),i(26," Include Genre "),e(),t(27,"a",19)(28,"span",11),s(29,"i",20),e(),i(30," Include Genre "),e(),t(31,"a",21)(32,"span",11),s(33,"i",22),e()()(),t(34,"div",23)(35,"h6")(36,"span",24),s(37,"i",18),e(),t(38,"b"),i(39,"Include genre:"),e(),i(40," If you include Historical , it will filter only mangas with Historical genre. (You can include multiple genres). "),e(),t(41,"h6")(42,"span",25),s(43,"i",20),e(),t(44,"b"),i(45,"Exclude genre:"),e(),i(46," If you include Comedy, Romance but exclude Ecchi, it will filter all mangas with Comedy and Romance but Ecchi. "),e()()(),t(47,"ul",26)(48,"li",27)(49,"a",28),i(50," ALL "),e()(),t(51,"li",29)(52,"a",30),i(53," Action "),e()(),t(54,"li",31)(55,"a",30),i(56," Doujinshi "),e()(),t(57,"li",29)(58,"a",30),i(59," Drama "),e()(),t(60,"li",29)(61,"a",30),i(62," Fantasy "),e()(),t(63,"li",29)(64,"a",30),i(65," Historical "),e()(),t(66,"li",29)(67,"a",30),i(68," Horror "),e()(),t(69,"li",29)(70,"a",30),i(71," Isekai "),e()(),t(72,"li",29)(73,"a",30),i(74," Manhua "),e()(),t(75,"li",29)(76,"a",30),i(77," Manhwa "),e()(),t(78,"li",29)(79,"a",30),i(80," Martial arts "),e()(),t(81,"li",29)(82,"a",30),i(83," Mecha "),e()(),t(84,"li",29)(85,"a",30),i(86," Medical "),e()(),t(87,"li",29)(88,"a",30),i(89," Mystery "),e()(),t(90,"li",29)(91,"a",30),i(92," Psychological "),e()(),t(93,"li",29)(94,"a",30),i(95," Romance "),e()(),t(96,"li",29)(97,"a",30),i(98," School life "),e()(),t(99,"li",29)(100,"a",30),i(101," Sci fi "),e()()(),t(102,"div",32)(103,"div",33)(104,"div",34)(105,"label",35),i(106,"Order By:"),e(),t(107,"select",36)(108,"option",37),i(109,"Latest Updated"),e(),t(110,"option",38),i(111,"Top View"),e(),t(112,"option",38),i(113,"New Manga"),e(),t(114,"option",38),i(115,"A - Z"),e()()()(),t(116,"div",33)(117,"div",34)(118,"label",35),i(119,"Status:"),e(),t(120,"select",36)(121,"option",37),i(122,"Ongoing and Completed"),e(),t(123,"option",38),i(124,"Ongoing"),e(),t(125,"option",38),i(126,"Completed"),e()()()()(),t(127,"div",32)(128,"div",33)(129,"div",34)(130,"label",35),i(131,"Keywords:"),e(),t(132,"select",36)(133,"option",37),i(134,"Alternative Name"),e(),t(135,"option",38),i(136,"Everything"),e(),t(137,"option",38),i(138,"Author"),e(),t(139,"option",38),i(140,"Name title"),e()()()()(),t(141,"div",32)(142,"div",6),s(143,"input",39),t(144,"button",40),i(145,"Search"),e()()(),t(146,"div",41)(147,"div",6)(148,"label",35),i(149,"URL to load my filter anywhere(only copy):"),e(),s(150,"input",42),e()()()(),t(151,"div",43)(152,"div",44)(153,"div",45)(154,"a",46),i(155,"Read Manga Online"),e()(),t(156,"div",45)(157,"a",47)(158,"span"),i(159,"Top View"),e()()(),t(160,"div",45)(161,"a",30)(162,"span"),i(163,"Page "),t(164,"span",48),i(165),e()()()()(),t(166,"div",49),S(167,ye,40,20,"ng-container",50),e(),t(168,"div",51)(169,"div",52),i(170),e(),t(171,"div",53)(172,"div",54)(173,"a",55),w("click",function(){return r.onPageChange(1)}),i(174,"FIRST (1)"),e()(),S(175,we,3,3,"div",56),t(176,"div",54)(177,"a",55),w("click",function(){return r.onPageChange(r.totalPages)}),i(178),e()()()()()(),t(179,"div",6)(180,"section",57)(181,"div",58)(182,"ul",59),S(183,Pe,4,8,"ng-container",50),e(),t(184,"ul",60)(185,"li",61)(186,"a",28),i(187," Latest "),e()(),t(188,"li",62)(189,"a",28),i(190," Newest "),e()(),t(191,"li",63)(192,"a",28),i(193," Top View "),e()()(),t(194,"ul",60)(195,"li",27)(196,"a",28),i(197," ALL "),e()(),t(198,"li",64)(199,"a",28),i(200," Completed "),e()(),t(201,"li",65)(202,"a",28),i(203," Ongoing "),e()()()()()()()()()(),s(204,"app-footer"),e()),m&2&&(l("ngIf",r.isLoading),a(49),l("routerLink",d(26,_))("queryParams",d(27,oe)),a(105),l("routerLink",d(28,ce)),a(11),v(r.currentPage),a(2),l("ngForOf",r.filteredMangasList),a(3),f("TOTAL: ",r.totalManga,""),a(2),y("disabled",r.currentPage===1),a(3),l("ngForOf",r.pagesToShow),a(),y("disabled",r.currentPage===r.totalPages),a(2),f("LAST (",r.totalPages,")"),a(5),l("ngForOf",r.mangaGenresList),a(3),l("routerLink",d(29,_))("queryParams",d(30,pe)),a(3),l("routerLink",d(31,_))("queryParams",d(32,ue)),a(3),l("routerLink",d(33,_))("queryParams",d(34,ge)),a(4),l("routerLink",d(35,_))("queryParams",d(36,oe)),a(3),l("routerLink",d(37,_))("queryParams",d(38,ve)),a(3),l("routerLink",d(39,_))("queryParams",d(40,_e)))},dependencies:[ne,ie,te,ee,re,J,Y,Z]})}}return o})();export{qe as TopMangaComponent};
