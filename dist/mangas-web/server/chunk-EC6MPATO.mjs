import './polyfills.server.mjs';
import{a as re}from"./chunk-BFCEQTNI.mjs";import{a as ae}from"./chunk-HRXPSE3H.mjs";import{a as ie,b as ne}from"./chunk-K4MJOIOR.mjs";import{$a as Q,H as $,I as a,J as y,Ja as Y,Ka as Z,La as J,O as f,P as l,Q as w,R as z,S as e,T as t,U as m,V as L,W as C,X as B,Y as b,Z as h,ba as i,ca as u,cb as X,da as S,db as ee,fb as te,ja as K,ka as d,la as W,m as G,ma as I,r as U,s as H}from"./chunk-7BJ56LUI.mjs";import{h as x}from"./chunk-5XUXGTUW.mjs";var _=()=>["/list-view"],oe=()=>({status:"all"}),fe=()=>["/"],he=()=>({category:"latest"}),Se=()=>({category:"newest"}),xe=()=>({category:"top-view"}),Ee=()=>({status:"completed"}),ye=()=>({status:"ongoing"}),we=r=>["/manga",r],be=(r,c)=>["/chapter",r,c],Pe=(r,c)=>({genres:r,genrenames:c});function Le(r,c){r&1&&(e(0,"div",66),m(1,"div",67),t())}function Ce(r,c){if(r&1&&(e(0,"div",45)(1,"a",68)(2,"span"),i(3),t()()()),r&2){let n=h();a(3),u(n.capitalize(n.category))}}function Ie(r,c){if(r&1&&(e(0,"div",45)(1,"a",68),i(2," Geners : "),e(3,"span"),i(4),t()()()),r&2){let n=h();a(4),u(n.genreNames.join(", "))}}function Te(r,c){if(r&1&&(e(0,"div",45)(1,"a",68),i(2," Status : "),e(3,"span"),i(4),t()()()),r&2){let n=h();a(4),u(n.capitalize(n.status))}}function Fe(r,c){if(r&1&&(e(0,"span"),i(1),t()),r&2){let n=h().$implicit;a(),S(": ",n.chapterTitle,"")}}function ke(r,c){if(r&1&&(L(0),e(1,"div",69)(2,"div",70),m(3,"img",71),e(4,"span"),i(5),t(),e(6,"span",72)(7,"span",73),i(8),t(),e(9,"span",11),m(10,"i",74),t()()(),e(11,"div",75)(12,"h2",76)(13,"a",77),i(14),t()(),e(15,"div",78)(16,"a",79),i(17),f(18,Fe,2,1,"span",80),t()(),e(19,"div",81)(20,"div",82)(21,"span",83),m(22,"i",84),t(),e(23,"span"),i(24),t()(),e(25,"div",85)(26,"span",83),m(27,"i",86),t(),e(28,"span"),i(29),t()(),e(30,"div",87)(31,"span",83),m(32,"i",88),t(),e(33,"span"),i(34),t()()(),e(35,"div",89),i(36),t(),e(37,"div",90)(38,"a",91),i(39,"Read More"),t()()()(),C()),r&2){let n=c.$implicit;a(3),l("src",n.cover,$)("alt",n.title),a(),z("badge "+n.popularityTag+"_badge"),a(),u(n.popularityTag),a(3),u(n.rating),a(5),l("routerLink",W(15,we,n.id)),a(),u(n.title),a(2),l("routerLink",I(17,be,n.chapterId,n.id)),a(),S(" Chapter ",n.chapter," "),a(),l("ngIf",n.chapterTitle),a(6),u(n.views),a(5),u(n.lastUpdated),a(5),u(n.author),a(2),S(" ",n.description," ")}}function Me(r,c){if(r&1){let n=B();e(0,"div",92)(1,"a",55),b("click",function(){let o=U(n).$implicit,g=h();return H(g.onPageChange(o))}),i(2),t()()}if(r&2){let n=c.$implicit,s=h();w("active",n===s.currentPage),a(2),u(n)}}function Ae(r,c){if(r&1&&(L(0),e(1,"li",93)(2,"a",28),i(3),t()(),C()),r&2){let n=c.$implicit;a(),l("id",n.id),a(),l("routerLink",d(4,_))("queryParams",I(5,Pe,n.id,n.name)),a(),S(" ",n.name," ")}}var Ke=(()=>{class r{constructor(n,s,o){this.mangaService=n,this.route=s,this.router=o,this.genreNames=[],this.page=1,this.mangaGenresList=[],this.filteredMangasList=[],this.isLoading=!1,this.currentPage=1,this.itemsPerPage=10,this.totalManga=0,this.totalPages=0,this.pagesToShow=[],this.offset=0,this.limit=10,this.genres=[],this.status="",this.category=""}ngOnInit(){this.route.queryParams.subscribe(n=>{this.genreNames=n.genrenames?n.genrenames.split(",").map(s=>this.capitalize(s.trim())):[],this.status=n.status||"",this.page=parseInt(n.page)||1,this.category=n.category||""}),this.route.queryParams.subscribe(n=>{this.currentPage=n.offset?parseInt(n.offset)/this.itemsPerPage+1:1,this.pagesToShow=[],this.offset=parseInt(n.offset)||0,this.limit=parseInt(n.limit)||10,this.genres=n.genres?[n.genres]:[],this.status=n.status||"",this.category=n.category||"",this.loadFilteredMangas(this.offset,this.limit,this.genres,this.status,this.category)}),this.loadGenresList()}capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)}loadFilteredMangas(n,s,o,g,le){return x(this,null,function*(){let se=n,me=s,de=o,ce=g,pe=le;this.isLoading=!0,this.mangaService.getMangaList(se,me,de,ce,pe).subscribe(T=>x(this,null,function*(){let F=yield Promise.all(T.data.map(p=>x(this,null,function*(){let k="https://via.placeholder.com/150",M="Unknown",Re=null,A=p.relationships.find(v=>v.type==="cover_art");if(A){let D=(yield this.mangaService.getCoverImage(A.id).toPromise()).data?.attributes?.fileName;D&&(k=`https://uploads.mangadex.org/covers/${p.id}/${D}.256.jpg`)}let R=p.relationships.find(v=>v.type==="author");R&&(M=(yield this.mangaService.getAuthor(R.id).toPromise()).data?.attributes?.name||"Unknown");let V=yield this.mangaService.getLatestChapter(p.id).toPromise(),N=V?.data?.[0]?.attributes||{},j=(yield this.mangaService.getStats(p.id).toPromise()).statistics?.[p.id]||{},P=j.follows||0,q=j.rating?.average||0,ue=q?(q/2).toFixed(1):"N/A",E="";P>5e4?E="ss":P>1e4&&(E="hot");let ge=new Date(p.attributes.createdAt);(new Date().getTime()-ge.getTime())/864e5<30&&(E="new");let O=p.attributes.altTitles||[],ve=O.find(v=>v.en)?.en||Object.values(O[0]||{})[0]||"No Title",_e=new Date(p.attributes.updatedAt).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric"});return this.totalManga=T.total||47276,this.totalPages=Math.ceil(this.totalManga/this.itemsPerPage),this.updatePagesArray(),this.isLoading=!1,{id:p.id,title:p.attributes.title.en||ve,cover:k,description:p.attributes.description.en||"No Description",author:M,chapterId:V?.data?.[0]?.id,chapter:N.chapter||"N/A",chapterTitle:N.title||"",tags:p.attributes.tags.map(v=>v.attributes.name.en),rating:ue,lastUpdated:_e,views:P,popularityTag:E}})));this.filteredMangasList=F,console.log(F)}))})}onPageChange(n){if(n<1||n>this.totalPages||n===this.currentPage)return;this.currentPage=n;let s=(n-1)*this.itemsPerPage;this.router.navigate([],{relativeTo:this.route,queryParams:{offset:s},queryParamsHandling:"merge"})}updatePagesArray(){let s=Math.max(1,this.currentPage-2),o=Math.min(this.totalPages,this.currentPage+2);this.pagesToShow=[];for(let g=s;g<=o;g++)this.pagesToShow.push(g)}loadGenresList(){this.mangaService.getGenresList().subscribe(n=>x(this,null,function*(){let s=yield Promise.all(n.data.map(o=>x(this,null,function*(){return{id:o.id,name:o.attributes.name.en}})));this.mangaGenresList=s.sort((o,g)=>o.name.localeCompare(g.name))}))}static{this.\u0275fac=function(s){return new(s||r)(y(ae),y(Q),y(X))}}static{this.\u0275cmp=G({type:r,selectors:[["app-list-view"]],standalone:!0,features:[K],decls:204,vars:44,consts:[["class","box-loader",4,"ngIf"],[1,"d-flex","flex-column","h-m-100"],[1,"flex-fill"],[1,"main_section"],[1,"container"],[1,"row"],[1,"col-md-12"],[1,"filter_wrapper"],[1,"filter_header"],[1,"filter_title"],["href","javascript:void(0)",1,"filter_btn","stretched-link"],[1,"icon"],[1,"fas","fa-plus"],[1,"filter_text"],["id","filter_body",1,"filter_body","d-none"],[1,"genre_wrapper"],[1,"genre_info_btn_wrapper"],["href","javscript:void(0)",1,"add_genre","genre_info_btn"],[1,"fas","fa-plus-circle"],["href","javscript:void(0)",1,"remove_genre","genre_info_btn"],[1,"fas","fa-minus-circle"],["href","javascript:void(0)","id","info_genre","onclick","HideGenresInfo()",1,"info_genre","genre_info_btn"],[1,"fas","fa-question-circle"],["id","genre_info",1,"genre_info","d-none"],[1,"add_genre","icon"],[1,"remove_genre","icon"],[1,"genres_list_wrapper"],["id","status_all",1,"list_item","status_all"],[3,"routerLink","queryParams"],[1,"list_item"],["href","javascript:void(0)"],[1,"list_item","inactive"],[1,"row","mt-2"],[1,"col-md-3"],[1,"d-flex","align-items-center","gap-2"],["for","",1,"form-label","fw-bold","text-nowrap","small"],[1,"form-select"],["selected",""],["value",""],["type","text","placeholder","Search Manga",1,"form-control"],[1,"search_btn"],[1,"row","mt-2","mb-2"],["type","text","placeholder","Search Manga","value","https://manganato.com/advanced_search?s=all&page=1","readonly","",1,"form-control"],[1,"list_view_container"],[1,"breadcrumb_wrapper"],[1,"breadcrumb_item"],[1,"pe-1",3,"routerLink"],["class","breadcrumb_item",4,"ngIf"],["id","currentPageNumber"],["id","list_view_items",1,"list_view_body"],[4,"ngFor","ngForOf"],[1,"pagination_wrapper"],[1,"total-page","page-item"],[1,"pages_wrapper"],[1,"page-item","active"],["href","javascript:void(0)",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"genres_section","list_view"],[1,"section_content"],["id","genres_list_container",1,"genres_list"],[1,"genres_list","border-bottom"],["id","sort_latest",1,"list_item","sort_latest"],["id","sort_newest",1,"list_item","sort_newest"],["id","sort_top-view",1,"list_item","sort_top-view"],["id","status_completed",1,"list_item","status_completed"],["id","status_ongoing",1,"list_item","status_ongoing"],[1,"box-loader"],[1,"loader"],["href","javascript:void(0)",1,"pe-1"],[1,"list_view_item"],[1,"item_img"],["referrerpolicy","no-referrer",1,"img-fluid",3,"src","alt"],[1,"rating"],[1,"content"],[1,"fas","fa-star"],[1,"item_content"],[1,"item_title"],[3,"routerLink"],[1,"item_chapter"],[1,"chapter_link",3,"routerLink"],[4,"ngIf"],[1,"item_info_wrapper"],[1,"info_item","item_views"],[1,"icon","me-1"],[1,"fas","fa-eye"],[1,"info_item","item_updated_date"],[1,"fas","fa-calendar"],[1,"info_item","item_author"],[1,"fas","fa-user"],[1,"item_discription"],[1,"item_btn_wrapper"],["href","javascript:void(0)",1,"item_read_more_btn"],[1,"page-item"],[1,"list_item",3,"id"]],template:function(s,o){s&1&&(f(0,Le,2,0,"div",0),e(1,"div",1),m(2,"app-header"),e(3,"main",2),m(4,"app-top-week"),e(5,"section",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h2",9),i(12,"FILTER (ADVANCED SEARCH)"),t(),e(13,"a",10)(14,"span",11),m(15,"i",12),t(),e(16,"span",13),i(17,"Show"),t()()(),e(18,"div",14)(19,"h5"),i(20,"Genres:"),t(),e(21,"div",15)(22,"div",16)(23,"a",17)(24,"span",11),m(25,"i",18),t(),i(26," Include Genre "),t(),e(27,"a",19)(28,"span",11),m(29,"i",20),t(),i(30," Include Genre "),t(),e(31,"a",21)(32,"span",11),m(33,"i",22),t()()(),e(34,"div",23)(35,"h6")(36,"span",24),m(37,"i",18),t(),e(38,"b"),i(39,"Include genre:"),t(),i(40," If you include Historical , it will filter only mangas with Historical genre. (You can include multiple genres). "),t(),e(41,"h6")(42,"span",25),m(43,"i",20),t(),e(44,"b"),i(45,"Exclude genre:"),t(),i(46," If you include Comedy, Romance but exclude Ecchi, it will filter all mangas with Comedy and Romance but Ecchi. "),t()()(),e(47,"ul",26)(48,"li",27)(49,"a",28),i(50," ALL "),t()(),e(51,"li",29)(52,"a",30),i(53," Action "),t()(),e(54,"li",31)(55,"a",30),i(56," Doujinshi "),t()(),e(57,"li",29)(58,"a",30),i(59," Drama "),t()(),e(60,"li",29)(61,"a",30),i(62," Fantasy "),t()(),e(63,"li",29)(64,"a",30),i(65," Historical "),t()(),e(66,"li",29)(67,"a",30),i(68," Horror "),t()(),e(69,"li",29)(70,"a",30),i(71," Isekai "),t()(),e(72,"li",29)(73,"a",30),i(74," Manhua "),t()(),e(75,"li",29)(76,"a",30),i(77," Manhwa "),t()(),e(78,"li",29)(79,"a",30),i(80," Martial arts "),t()(),e(81,"li",29)(82,"a",30),i(83," Mecha "),t()(),e(84,"li",29)(85,"a",30),i(86," Medical "),t()(),e(87,"li",29)(88,"a",30),i(89," Mystery "),t()(),e(90,"li",29)(91,"a",30),i(92," Psychological "),t()(),e(93,"li",29)(94,"a",30),i(95," Romance "),t()(),e(96,"li",29)(97,"a",30),i(98," School life "),t()(),e(99,"li",29)(100,"a",30),i(101," Sci fi "),t()()(),e(102,"div",32)(103,"div",33)(104,"div",34)(105,"label",35),i(106,"Order By:"),t(),e(107,"select",36)(108,"option",37),i(109,"Latest Updated"),t(),e(110,"option",38),i(111,"Top View"),t(),e(112,"option",38),i(113,"New Manga"),t(),e(114,"option",38),i(115,"A - Z"),t()()()(),e(116,"div",33)(117,"div",34)(118,"label",35),i(119,"Status:"),t(),e(120,"select",36)(121,"option",37),i(122,"Ongoing and Completed"),t(),e(123,"option",38),i(124,"Ongoing"),t(),e(125,"option",38),i(126,"Completed"),t()()()()(),e(127,"div",32)(128,"div",33)(129,"div",34)(130,"label",35),i(131,"Keywords:"),t(),e(132,"select",36)(133,"option",37),i(134,"Alternative Name"),t(),e(135,"option",38),i(136,"Everything"),t(),e(137,"option",38),i(138,"Author"),t(),e(139,"option",38),i(140,"Name title"),t()()()()(),e(141,"div",32)(142,"div",6),m(143,"input",39),e(144,"button",40),i(145,"Search"),t()()(),e(146,"div",41)(147,"div",6)(148,"label",35),i(149,"URL to load my filter anywhere(only copy):"),t(),m(150,"input",42),t()()()(),e(151,"div",43)(152,"div",44)(153,"div",45)(154,"a",46),i(155,"Read Manga Online"),t()(),f(156,Ce,4,1,"div",47)(157,Ie,5,1,"div",47)(158,Te,5,1,"div",47),e(159,"div",45)(160,"a",30)(161,"span"),i(162,"Page "),e(163,"span",48),i(164),t()()()()(),e(165,"div",49),f(166,ke,40,20,"ng-container",50),t(),e(167,"div",51)(168,"div",52),i(169),t(),e(170,"div",53)(171,"div",54)(172,"a",55),b("click",function(){return o.onPageChange(1)}),i(173,"FIRST (1)"),t()(),f(174,Me,3,3,"div",56),e(175,"div",54)(176,"a",55),b("click",function(){return o.onPageChange(o.totalPages)}),i(177),t()()()()()(),e(178,"div",6)(179,"section",57)(180,"div",58)(181,"ul",59),f(182,Ae,4,8,"ng-container",50),t(),e(183,"ul",60)(184,"li",61)(185,"a",28),i(186," Latest "),t()(),e(187,"li",62)(188,"a",28),i(189," Newest "),t()(),e(190,"li",63)(191,"a",28),i(192," Top View "),t()()(),e(193,"ul",60)(194,"li",27)(195,"a",28),i(196," ALL "),t()(),e(197,"li",64)(198,"a",28),i(199," Completed "),t()(),e(200,"li",65)(201,"a",28),i(202," Ongoing "),t()()()()()()()()()(),m(203,"app-footer"),t()),s&2&&(l("ngIf",o.isLoading),a(49),l("routerLink",d(29,_))("queryParams",d(30,oe)),a(105),l("routerLink",d(31,fe)),a(2),l("ngIf",o.category),a(),l("ngIf",o.genreNames.length),a(),l("ngIf",o.status),a(6),u(o.currentPage),a(2),l("ngForOf",o.filteredMangasList),a(3),S("TOTAL: ",o.totalManga,""),a(2),w("disabled",o.currentPage===1),a(3),l("ngForOf",o.pagesToShow),a(),w("disabled",o.currentPage===o.totalPages),a(2),S("LAST (",o.totalPages,")"),a(5),l("ngForOf",o.mangaGenresList),a(3),l("routerLink",d(32,_))("queryParams",d(33,he)),a(3),l("routerLink",d(34,_))("queryParams",d(35,Se)),a(3),l("routerLink",d(36,_))("queryParams",d(37,xe)),a(4),l("routerLink",d(38,_))("queryParams",d(39,oe)),a(3),l("routerLink",d(40,_))("queryParams",d(41,Ee)),a(3),l("routerLink",d(42,_))("queryParams",d(43,ye)))},dependencies:[ne,ie,re,J,Y,Z,te,ee]})}}return r})();export{Ke as ListViewComponent};
